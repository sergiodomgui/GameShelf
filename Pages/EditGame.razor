@page "/editgame/{GameId:guid}"
@using GameShelfWeb.Models
@using GameShelfWeb.Data
@inject GameService GameService
@inject NavigationManager Navigation

<h3>Editar Juego</h3>

@if (game == null)
{
    <p>Cargando...</p>
}
else
{
    <EditForm Model="game" OnValidSubmit="HandleValidSubmit">
        <InputText @bind-Value="game.Title" placeholder="TÃ­tulo" class="form-control mb-2" />
        <InputText @bind-Value="game.Platform" placeholder="Plataforma" class="form-control mb-2" />
        <InputSelect @bind-Value="game.Status" class="form-control mb-2">
            @foreach (var status in Enum.GetValues<GameStatus>())
            {
                <option value="@status">@status</option>
            }
        </InputSelect>
        <button type="submit" class="btn btn-success">Guardar</button>
    </EditForm>
}

@code {
    [Parameter] public Guid GameId { get; set; }
    private Game? game;

    protected override void OnInitialized()
    {
        game = GameService.GetAll().FirstOrDefault(g => g.Id == GameId);
    }

    private void HandleValidSubmit()
    {
        if (game != null) GameService.Update(game);
        Navigation.NavigateTo("/");
    }
}

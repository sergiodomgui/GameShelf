@page "/editgame/{GameId:guid}"
@using GameShelfWeb.Models
@using GameShelfWeb.Data
@inject GameRepository Repo
@inject NavigationManager Nav

<h3>Editar Juego</h3>

@if (game == null) { <p>Cargando...</p> }
else
{
    <EditForm Model="game" OnValidSubmit="HandleValidSubmit">
        <InputText @bind-Value="game.Title" placeholder="Título" class="form-control mb-2" />
        <InputText @bind-Value="game.Platform" placeholder="Plataforma" class="form-control mb-2" />
        <InputTextArea @bind-Value="game.Description" placeholder="Descripción" class="form-control mb-2" />
        <InputSelect @bind-Value="game.Status" class="form-control mb-2">
            @foreach (var s in Enum.GetValues<GameStatus>())
            {
                <option value="@s">@s</option>
            }
        </InputSelect>
        <button type="submit" class="btn btn-success">Guardar</button>
    </EditForm>
}

@code {
    [Parameter] public Guid GameId { get; set; }
    private Game? game;

    protected override void OnInitialized()
    {
        game = Repo.Get(GameId);
    }

    private void HandleValidSubmit()
    {
        if (game != null)
        {
            Repo.Update(game);
            Nav.NavigateTo($"/gamedetails/{game.Id}");
        }
    }
}
